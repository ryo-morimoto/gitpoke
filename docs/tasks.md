# GitPoke タスク管理

## 現在のフェーズ: Rust実装準備

### 完了済み ✅
- [x] 開発アプローチの決定（Rust新規開発）
- [x] デプロイプラットフォームの選択（GCP Cloud Run）
- [x] アーキテクチャパターンの決定（モノリシック）
- [x] データストレージ戦略の決定
- [x] Rustクレート選択
- [x] エラーハンドリング戦略
- [x] テスト戦略
- [x] CI/CDパイプライン設計

### 進行中 🔄
- [ ] プロジェクトの初期セットアップ
  - [ ] Cargo.toml作成
  - [ ] 基本的なプロジェクト構造
  - [ ] 開発環境の構築

### TODO 📋

#### Phase 1: MVP開発（2週間）
- [ ] **基本実装**
  - [ ] axumサーバーの基本セットアップ
  - [ ] ヘルスチェックエンドポイント
  - [ ] 基本的なエラーハンドリング実装
  
- [ ] **GitHub統合**
  - [ ] GitHub App作成・設定
  - [ ] octocrabを使ったGitHub API統合
  - [ ] GraphQL APIでContributionCalendar取得
  - [ ] User Access Token管理
  
- [ ] **バッジ機能**
  - [ ] SVGバッジ生成ロジック
  - [ ] アクティビティ判定ロジック（7日ルール）
  - [ ] バッジエンドポイント実装
  
- [ ] **キャッシュ実装**
  - [ ] Redis接続設定
  - [ ] キャッシュロジック実装
  - [ ] TTL管理

#### Phase 2: つっつき機能（1週間）
- [ ] **API実装**
  - [ ] CORS対応つっつきAPI
  - [ ] レート制限実装
  - [ ] 匿名ユーザー対応
  
- [ ] **データ永続化**
  - [ ] Firestore統合
  - [ ] つっつき履歴の保存
  - [ ] 通知設定の管理
  
- [ ] **バッジ拡張**
  - [ ] クリック可能なSVG生成
  - [ ] JavaScript埋め込み
  - [ ] フィードバック表示

#### Phase 3: 本番準備
- [ ] **インフラ**
  - [ ] GCPプロジェクト設定
  - [ ] Cloud Run設定
  - [ ] Secret Manager設定
  
- [ ] **CI/CD**
  - [ ] GitHub Actions設定
  - [ ] Workload Identity設定
  - [ ] 自動デプロイパイプライン
  
- [ ] **監視・運用**
  - [ ] Cloud Logging設定
  - [ ] アラート設定
  - [ ] ダッシュボード作成

## 未解決の設計課題

### 技術的課題
1. **Token Refresh戦略**
   - User Access Tokenの8時間制限への対応
   - 自動リフレッシュの実装方法
   - 期限切れトークンのハンドリング

2. **レート制限の詳細設計**
   - Durable Objects相当の機能をRedisで実装
   - IPベース/ユーザーベースの制限値
   - レート制限ヘッダーの実装

3. **キャッシュ無効化パターン**
   - ユーザーアクティビティ更新時の処理
   - 多層キャッシュの一貫性保証
   - stale-while-revalidateの実装

### 運用課題
1. **監視戦略**
   - Cloud Logging vs 外部サービス
   - メトリクス収集の詳細
   - エラー追跡サービスの選定

2. **セキュリティ対策**
   - CORS設定の詳細
   - XSS/CSRF防御
   - 入力検証とサニタイゼーション

## ロードマップ

### 2024年1月
- Week 1-2: MVP開発
- Week 3: つっつき機能実装
- Week 4: テストとバグ修正

### 2024年2月
- Week 1: 本番環境準備
- Week 2: ベータリリース
- Week 3-4: フィードバック対応と改善

### 将来の機能拡張（優先度順）
1. Webhook通知（アプリアンインストール時）
2. 詳細な統計ダッシュボード
3. カスタムバッジデザイン
4. Slack/Discord統合
5. Organization対応
6. GitLab/Bitbucket対応

## 成功指標

### MVP完了基準
- [ ] GitHub App認証が動作
- [ ] バッジが正しく生成・表示される
- [ ] 7日ルールが正しく動作
- [ ] キャッシュが効いている
- [ ] エラー時もサービスが落ちない

### Phase 2完了基準
- [ ] つっつきが正しく記録される
- [ ] レート制限が機能している
- [ ] CORS対応でGitHub.comから呼び出せる
- [ ] 通知設定が保存される

### 本番リリース基準
- [ ] 自動デプロイが動作
- [ ] 監視・アラートが設定済み
- [ ] ドキュメントが完成
- [ ] セキュリティレビュー完了